<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Match</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; background: #f0f2f5; margin: 0; }
        h1 { color: #333; margin-bottom: 20px; }
        .game-info { margin-bottom: 20px; font-size: 1.2rem; display: flex; gap: 20px; }
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; max-width: 600px; width: 95vw; aspect-ratio: 1; }
        .card { background: #fff; border-radius: 8px; cursor: pointer; position: relative; transform-style: preserve-3d; transition: transform 0.5s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; font-size: 2rem; }
        .card.flipped { transform: rotateY(180deg); }
        .card.matched { visibility: hidden; opacity: 0; transition: opacity 0.5s; }

        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; border-radius: 8px; }
        .card-front { background: #4a90e2; transform: rotateY(0deg); color: white; font-weight: bold; font-size: 2rem; }
        .card-back { background: white; transform: rotateY(180deg); border: 2px solid #4a90e2; }

        button { padding: 10px 20px; font-size: 1rem; background: #4a90e2; color: white; border: none; border-radius: 5px; cursor: pointer; margin-top: 20px; }
        button:hover { background: #357abd; }

        @media (max-width: 500px) {
            .grid { grid-template-columns: repeat(4, 1fr); gap: 5px; }
            .card-back { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <h1>Memory Match</h1>
    <div class="game-info">
        <span>Moves: <span id="moves">0</span></span>
        <span>Time: <span id="time">0s</span></span>
    </div>
    <div class="grid" id="grid"></div>
    <button onclick="confirmRestart()">Restart Game</button>

    <!-- Results Modal -->
    <div id="resultModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 100; justify-content: center; align-items: center; flex-direction: column; color: white;">
        <h2 style="font-size: 3rem; margin-bottom: 20px;">You Won!</h2>
        <p style="font-size: 1.5rem;">Moves: <span id="finalMoves">0</span></p>
        <p style="font-size: 1.5rem;">Time: <span id="finalTime">0s</span></p>
        <button onclick="initGame()" style="background: #2ecc71; margin-top: 30px;">Play Again</button>
    </div>

    <!-- Restart Confirmation Modal -->
    <div id="confirmModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 100; justify-content: center; align-items: center; flex-direction: column; color: white;">
        <h2 style="margin-bottom: 20px;">Restart Game?</h2>
        <p>Are you sure you want to restart?</p>
        <div style="display: flex; gap: 20px; margin-top: 20px;">
            <button onclick="initGame(); closeConfirm()" style="background: #e74c3c;">Yes</button>
            <button onclick="closeConfirm()" style="background: #95a5a6;">No</button>
        </div>
    </div>

    <script>
        const emojis = ['ðŸ¶', 'ðŸ±', 'ðŸ­', 'ðŸ¹', 'ðŸ°', 'ðŸ¦Š', 'ðŸ»', 'ðŸ¼'];
        let cards = [...emojis, ...emojis];
        let flippedCards = [];
        let matchedPairs = 0;
        let moves = 0;
        let timer = null;
        let seconds = 0;
        let isLocked = false;

        const grid = document.getElementById('grid');
        const movesDisplay = document.getElementById('moves');
        const timeDisplay = document.getElementById('time');

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function initGame() {
            grid.innerHTML = '';
            cards = shuffle([...emojis, ...emojis]);
            flippedCards = [];
            matchedPairs = 0;
            moves = 0;
            seconds = 0;
            isLocked = false;

            movesDisplay.innerText = moves;
            timeDisplay.innerText = '0s';
            clearInterval(timer);
            timer = setInterval(() => {
                seconds++;
                timeDisplay.innerText = seconds + 's';
            }, 1000);

            cards.forEach((emoji, index) => {
                const card = document.createElement('div');
                card.classList.add('card');
                card.dataset.value = emoji;
                card.dataset.index = index;

                const front = document.createElement('div');
                front.classList.add('card-face', 'card-front');
                front.innerText = '?';

                const back = document.createElement('div');
                back.classList.add('card-face', 'card-back');
                back.innerText = emoji;

                card.appendChild(front);
                card.appendChild(back);
                card.addEventListener('click', flipCard);
                grid.appendChild(card);
            });
        }

        function flipCard() {
            if (isLocked || this.classList.contains('flipped') || this.classList.contains('matched')) return;

            this.classList.add('flipped');
            flippedCards.push(this);

            if (flippedCards.length === 2) {
                moves++;
                movesDisplay.innerText = moves;
                checkForMatch();
            }
        }

        function checkForMatch() {
            isLocked = true;
            const [card1, card2] = flippedCards;

            if (card1.dataset.value === card2.dataset.value) {
                matchedPairs++;
                flippedCards = [];
                isLocked = false;
                setTimeout(() => {
                    card1.classList.add('matched');
                    card2.classList.add('matched');
                    if (matchedPairs === emojis.length) {
                        clearInterval(timer);
                        showResult();
                    }
                }, 500);
            } else {
                setTimeout(() => {
                    card1.classList.remove('flipped');
                    card2.classList.remove('flipped');
                    flippedCards = [];
                    isLocked = false;
                }, 1000);
            }
        }

        function showResult() {
            document.getElementById('finalMoves').innerText = moves;
            document.getElementById('finalTime').innerText = seconds + 's';
            document.getElementById('resultModal').style.display = 'flex';
        }

        function confirmRestart() {
            if (matchedPairs > 0 && matchedPairs < emojis.length) {
                document.getElementById('confirmModal').style.display = 'flex';
            } else {
                initGame();
            }
        }

        function closeConfirm() {
            document.getElementById('confirmModal').style.display = 'none';
        }

        const _originalInitGame = initGame;
        initGame = function() {
            document.getElementById('resultModal').style.display = 'none';
            document.getElementById('confirmModal').style.display = 'none';
            _originalInitGame();
        }

        // Call original init first time
        _originalInitGame();
    </script>
</body>
</html>
