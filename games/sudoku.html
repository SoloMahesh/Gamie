<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sudoku</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; background: #fdfdfd; }
        h1 { margin-bottom: 20px; }

        .board {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            width: 90vw;
            max-width: 450px;
            aspect-ratio: 1;
            border: 2px solid #333;
            background: #fff;
        }

        .cell {
            border: 1px solid #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            user-select: none;
        }

        /* Thicker borders for 3x3 blocks */
        .cell:nth-child(3n) { border-right: 2px solid #333; }
        .cell:nth-child(9n) { border-right: none; } /* Edge case handled by board border */
        .cell:nth-child(n+19):nth-child(-n+27),
        .cell:nth-child(n+46):nth-child(-n+54) { border-bottom: 2px solid #333; }

        .cell.selected { background: #bbdefb; }
        .cell.fixed { font-weight: bold; color: #000; }
        .cell.user { color: #1976d2; }
        .cell.error { background: #ffcdd2; }
        .cell.highlight { background: #e3f2fd; } /* Same number highlight */

        .numpad {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-top: 20px;
            width: 90vw;
            max-width: 450px;
        }

        .num-btn {
            padding: 15px;
            font-size: 1.5rem;
            background: #eee;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
        }

        .num-btn:active { background: #ddd; }

        .controls { margin-top: 20px; display: flex; gap: 10px; }
        button.action-btn { padding: 10px 20px; font-size: 1rem; cursor: pointer; background: #333; color: white; border: none; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Sudoku</h1>
    <div class="board" id="board"></div>

    <div class="numpad">
        <button class="num-btn" onclick="fillNumber(1)">1</button>
        <button class="num-btn" onclick="fillNumber(2)">2</button>
        <button class="num-btn" onclick="fillNumber(3)">3</button>
        <button class="num-btn" onclick="fillNumber(4)">4</button>
        <button class="num-btn" onclick="fillNumber(5)">5</button>
        <button class="num-btn" onclick="fillNumber(6)">6</button>
        <button class="num-btn" onclick="fillNumber(7)">7</button>
        <button class="num-btn" onclick="fillNumber(8)">8</button>
        <button class="num-btn" onclick="fillNumber(9)">9</button>
        <button class="num-btn" onclick="fillNumber(0)">âŒ«</button>
    </div>

    <div class="controls">
        <button class="action-btn" onclick="newGame()">New Game</button>
        <button class="action-btn" onclick="checkSolution()">Check</button>
    </div>

    <script>
        // Simple Sudoku Generator (Backtracking)
        const boardElement = document.getElementById('board');
        let solution = [];
        let puzzle = [];
        let selectedCellIndex = -1;

        function initGame() {
            boardElement.innerHTML = '';
            for (let i = 0; i < 81; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                cell.dataset.index = i;
                cell.addEventListener('click', () => selectCell(i));
                boardElement.appendChild(cell);
            }
        }

        function selectCell(index) {
            if (puzzle[index] !== 0) return; // Cannot select fixed cells

            // Remove previous selection
            if (selectedCellIndex !== -1) {
                document.querySelector(`.cell[data-index="${selectedCellIndex}"]`).classList.remove('selected');
            }

            selectedCellIndex = index;
            document.querySelector(`.cell[data-index="${index}"]`).classList.add('selected');

            // Highlight cells with same number? (Enhancement)
        }

        function fillNumber(num) {
            if (selectedCellIndex === -1) return;

            const cell = document.querySelector(`.cell[data-index="${selectedCellIndex}"]`);
            if (num === 0) {
                cell.innerText = '';
                cell.classList.remove('user');
            } else {
                cell.innerText = num;
                cell.classList.add('user');
            }
        }

        function generateSudoku() {
            // Empty board
            solution = Array(81).fill(0);
            solve(solution);

            // Remove numbers to create puzzle
            puzzle = [...solution];
            let attempts = 40; // Number of cells to remove
            while (attempts > 0) {
                let idx = Math.floor(Math.random() * 81);
                if (puzzle[idx] !== 0) {
                    puzzle[idx] = 0;
                    attempts--;
                }
            }

            renderBoard();
        }

        function isValid(board, row, col, num) {
            for (let x = 0; x < 9; x++) {
                if (board[row * 9 + x] === num || board[x * 9 + col] === num) return false;
            }
            const startRow = row - row % 3;
            const startCol = col - col % 3;
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 3; j++) {
                    if (board[(i + startRow) * 9 + (j + startCol)] === num) return false;
                }
            }
            return true;
        }

        function solve(board) {
            for (let i = 0; i < 81; i++) {
                if (board[i] === 0) {
                    const nums = [1, 2, 3, 4, 5, 6, 7, 8, 9].sort(() => Math.random() - 0.5);
                    for (let num of nums) {
                        const row = Math.floor(i / 9);
                        const col = i % 9;
                        if (isValid(board, row, col, num)) {
                            board[i] = num;
                            if (solve(board)) return true;
                            board[i] = 0;
                        }
                    }
                    return false;
                }
            }
            return true;
        }

        function renderBoard() {
            const cells = document.querySelectorAll('.cell');
            cells.forEach((cell, i) => {
                cell.innerText = '';
                cell.className = 'cell';
                if (puzzle[i] !== 0) {
                    cell.innerText = puzzle[i];
                    cell.classList.add('fixed');
                }
            });
            selectedCellIndex = -1;
        }

        function checkSolution() {
            const cells = document.querySelectorAll('.cell');
            let isCorrect = true;
            let isComplete = true;

            cells.forEach((cell, i) => {
                const val = parseInt(cell.innerText) || 0;
                cell.classList.remove('error');

                if (val === 0) {
                    isComplete = false;
                } else if (val !== solution[i]) {
                    cell.classList.add('error');
                    isCorrect = false;
                }
            });

            if (isComplete && isCorrect) {
                alert("Congratulations! You solved it!");
            }
        }

        function newGame() {
            generateSudoku();
        }

        initGame();
        newGame();
    </script>
</body>
</html>
